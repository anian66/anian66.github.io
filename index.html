<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Meow</title>
    <!-- 引入 Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* 导入 Inter 字体 */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@100..900;display=swap');
        
        body {
            font-family: 'Inter', sans-serif;
            background-color: #000; /* 黑色背景 */
            min-height: 100vh;
            overflow: hidden; 
        }

        /* 锁屏界面特有的动画指针 */
        .bounce-arrow {
            animation: bounce 2s infinite;
        }
        @keyframes bounce {
            0%, 20%, 50%, 80%, 100% {
                transform: translateY(0);
            }
            40% {
                transform: translateY(-20px);
            }
            60% {
                transform: translateY(-10px);
            }
        }

        /* Horizontal Unlock Slider Styles */
        .unlock-area {
            position: relative;
            width: 300px;
            height: 60px;
            background: rgba(255, 255, 255, 0.1);
            border-radius: 30px;
            overflow: hidden;
            user-select: none;
            -webkit-user-select: none;
        }

        .unlock-handle {
            position: absolute;
            top: 0;
            left: 0;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #00bfff, #0078ff);
            border-radius: 50%;
            transition: left 0.2s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        
        /* 模拟手机壁纸 */
        #main-content {
            background-image: url('https://placehold.co/480x1000/374151/ffffff/png?text=Mobile+Wallpaper');
            background-size: cover;
            background-position: center;
        }
        
        /* 隐藏滚动条但保留滚动功能 */
        .app-grid-area::-webkit-scrollbar {
            display: none;
        }
        .app-grid-area {
            -ms-overflow-style: none;  /* IE and Edge */
            scrollbar-width: none;  /* Firefox */
        }
        
        /* 按钮按压效果基类 */
        .app-icon-btn, .dock-icon-btn, .toggle-btn {
            transition: transform 0.1s ease-out;
            touch-action: manipulation; /* 优化移动端触摸响应 */
        }
        .app-icon-btn:active, .dock-icon-btn:active, .toggle-btn:active {
            transform: scale(0.9);
        }

        /* NEW: Jiggle Keyframe for Edit Mode */
        @keyframes jiggle {
            0% { transform: rotate(0deg) scale(1); }
            15% { transform: rotate(-1deg) scale(1.02); }
            30% { transform: rotate(1deg) scale(1.02); }
            45% { transform: rotate(0deg) scale(1); }
            60% { transform: rotate(-1deg) scale(1.02); }
            75% { transform: rotate(1deg) scale(1.02); }
            100% { transform: rotate(0deg) scale(1); }
        }

        .jiggle {
            animation: jiggle 0.35s infinite ease-in-out alternate;
            cursor: grab;
        }

        /* 统一 App 启动的模态框动画 */
        .app-modal { 
            /* ADDED w-full h-full for explicit sizing */
            width: 100%;
            height: 100%;
            transition: transform 0.25s ease-in-out; 
            transform: translateY(100%); /* 初始状态在屏幕外 */
        }
        .app-modal.is-open { 
            transform: translateY(0);
        }

        /* Bluetooth Bottom Sheet (底部操作面板) - 优化时长和曲线 */
        #bluetooth-config-modal {
            transition: transform 0.25s ease-in-out;
            transform: translateY(100%); /* 初始状态在屏幕外 */
        }
        #bluetooth-config-modal.is-open {
            transform: translateY(0);
        }
        
        /* 通知中心动画 - 优化时长和曲线 */
        #notification-center {
            /* ADDED w-full h-full for explicit sizing */
            width: 100%;
            height: 100%;
            transition: transform 0.25s ease-in-out;
            transform: translateY(-100%); /* 初始状态在屏幕外上方 */
        }
        
        /* ==== NEW VIRTUAL STATUS BAR STYLES ==== */
        .status-bar {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 6px 14px;
            background: rgba(255, 255, 255, 0.08);
            color: #fff;
            font-family: "Inter", "PingFang SC", sans-serif;
            font-size: 14px;
            letter-spacing: 0.5px;
            backdrop-filter: blur(10px);
            border-radius: 10px;
            user-select: none;
        }

        .status-left,
        .status-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .status-icon {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            font-size: 13px;
        }

        .status-weather::before {
            content: "☁️ "; /* Cloud icon for weather */
        }

        .status-network::before {
            content: "📶 "; /* Signal icon for network */
        }

        .status-battery::before {
            content: "🔋 "; /* Battery icon for battery */
        }
        /* ==== END NEW VIRTUAL STATUS BAR STYLES ==== */

        /* NEW: Home Indicator beautification (美化 Home 栏) */
        #home-indicator-container > div {
            transition: all 0.2s ease-in-out;
        }
        #home-indicator-container:active > div {
            transform: scale(0.9); /* 点击时缩小 */
            background-color: #ffffff; /* 点击时变全白 */
            box-shadow: 0 0 12px rgba(255, 255, 255, 0.7) !important; /* 增强辉光 */
        }

        /* NEW: Added keyframe for JS-based click animation */
        @keyframes pop {
            0% { transform: scale(0.9); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .animate-pop {
            animation: pop 0.2s ease-in-out;
        }
        /* Page container transition for swiping */
        #page-container {
            will-change: transform;
        }

        /* NEW: Active state for toggles, as per user's new functions */
        .toggle-btn.active {
            color: white;
        }
        #flashlight-toggle.active {
            background-color: #f59e0b; /* 手电筒激活 (琥珀色/黄色) */
        }
        #bluetooth-toggle.active {
             background-color: #4f46e5; /* 蓝牙激活 (蓝色) */
        }
        /* Connection state still overrides toggle state */
        #bluetooth-toggle.bg-green-500 {
            background-color: #22c55e; /* 确保连接时的绿色优先 */
        }

    </style>
</head>
<body>

    <!-- 1. Outer Centering Container -->
    <div class="flex items-center justify-center w-screen h-screen">
        
        <!-- 2. 手机框架 (Phone Frame) - 约束尺寸和比例 -->
        <div id="phone-frame"
            class="relative shadow-2xl rounded-[2rem] bg-gray-900 overflow-hidden"
            style="
                width: 95vw;
                max-width: 412px;
                height: auto;
                aspect-ratio: 412 / 896;
                display: flex;
                align-items: stretch;
                justify-content: center;
            ">

            <!-- 3. 手机屏幕显示区 - 确保内容和锁屏层填充满这个区域 -->
            <div id="inner-screen" class="absolute inset-0 rounded-[2.7rem] overflow-hidden bg-white">

                <!-- Main Content Container (Home Screen) -->
                <div id="main-content" 
                    class="w-full h-full transition-all duration-500 ease-in-out flex flex-col p-2" 
                    style="transform: scale(0.95); filter: blur(2px);">
                    
                    <!-- A. Status Bar (状态栏: 实时同步) -->
                    <div class="status-bar flex-shrink-0 mx-2">
                        <div class="status-left">
                            <span class="status-time">--:--</span>
                            <span class="status-weather">--°C</span>
                        </div>
                        <div class="status-right">
                            <span class="status-network">--</span>
                            <span class="status-battery">--%</span>
                        </div>
                    </div>
                    
                    <!-- NEW: Weather/Time/Location Widget (置顶显示) -->
                    <div id="time-weather-widget" class="flex-shrink-0 mt-4 mx-4 p-5 bg-white/10 backdrop-blur-md rounded-3xl text-white shadow-xl w-[90%]">
                        <div class="flex items-center justify-between">
                            <!-- Left: Clock -->
                            <div>
                                <span id="widget-time" class="text-6xl font-extrabold leading-none">10:16</span>
                                <span id="widget-date" class="block text-sm font-medium text-gray-300 mt-1">周四, 10月23日</span>
                            </div>
                            <!-- Right: Weather/Location -->
                            <div class="text-right">
                                <span id="widget-temp-display" class="text-3xl font-bold">22°C</span>
                                <div class="flex items-center justify-end text-sm text-gray-300 mt-1">
                                    <svg xmlns="http://www.w3.org/2000/svg" class="w-4 h-4 mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 19V5M19 12H5"/></svg>
                                    <span id="widget-location-display">晴朗, 上海</span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- END NEW WIDGET -->

                    <!-- B. SWIPEABLE PAGE CONTAINER (应用图标区) -->
                    <div id="swipe-wrapper" class="flex-grow overflow-hidden relative">
                        
                        <!-- Horizontal Page Container (w-[200%], flex row, handles translation) -->
                        <div id="page-container" class="flex h-full w-[200%] transition-transform duration-300 ease-out">
                            
                            <!-- PAGE 1: 主屏幕第一页 -->
                            <div id="page-1" class="w-1/2 h-full flex flex-col p-4 pt-8">
                                <div class="flex-grow app-grid-area overflow-y-auto">
                                    <!-- 占位符应用图标网格 -->
                                    <div class="grid grid-cols-4 gap-y-6 pt-4">
                                        
                                        <!-- ROW 1 -->
                                        <!-- 1. 消息 -->
                                        <button id="message-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-red-500 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                                            </div>
                                            <span>消息</span>
                                        </button>
                                        
                                        <!-- 2. 相册 -->
                                        <button id="gallery-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-green-500 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><circle cx="8.5" cy="8.5" r="1.5"></circle><polyline points="21 15 16 10 5 21"></polyline></svg>
                                            </div>
                                            <span>相册</span>
                                        </button>

                                        <!-- 3. 设置 -->
                                        <button id="settings-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-gray-500 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83l-2.83 2.83a2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V23"></path><path d="M6 15a1.65 1.65 0 0 0-.33 1.82l-.06.06a2 2 0 0 1 0 2.83l2.83 2.83a2 2 0 0 1 2.83 0l.06-.06a1.65 1.65 0 0 0 1.82-.33 1.65 1.65 0 0 0 1 1.51V23"></path><path d="M19.4 9a1.65 1.65 0 0 0 .33-1.82l-.06-.06a2 2 0 0 1 0-2.83l-2.83-2.83a2 2 0 0 1-2.83 0l-.06.06a1.65 1.65 0 0 0-1.82.33 1.65 1.65 0 0 0-1-1.51V1"></path><path d="M6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83l2.83-2.83a2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33 1.65 1.65 0 0 0 1-1.51V1"></path></svg>
                                            </div>
                                            <span>设置</span>
                                        </button>

                                        <!-- 4. 浏览器 -->
                                        <button id="browser-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-yellow-500 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="12"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>
                                            </div>
                                            <span>浏览器</span>
                                        </button>
                                        
                                        <!-- ROW 2 -->
                                        <!-- 5. 音乐 -->
                                        <button id="music-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-pink-500 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M9 18V5l12-2v13"></path><circle cx="6" cy="18" r="3"></circle><circle cx="18" cy="16" r="3"></circle></svg>
                                            </div>
                                            <span>音乐</span>
                                        </button>

                                        <!-- 6. AI 助手 (点击启动 Modal) -->
                                        <button id="ai-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-indigo-500 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v2M12 20v2M20 12h2M2 12h2M15 3.5l-1.5 1.5M10.5 19l1.5 1.5M18.5 15l-1.5 1.5M5.5 8l1.5 1.5"/></svg>
                                            </div>
                                            <span>AI 宣言</span>
                                        </button>
                                        
                                        <!-- 7. X (Twitter) -->
                                        <button id="x-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-black rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="currentColor" stroke="none"><path d="M18.9 4.3l.9-1.3c-.6-.2-1.2-.3-1.8-.3C15.3 2.7 13.5 4.9 13.5 7.5v1.2H12c-.5 0-1 .4-1 .9v1.2c0 .5.5.9 1 .9h1.5v3.4c0 .8.6 1.5 1.5 1.5h1.2c.8 0 1.5-.6 1.5-1.5v-3.4H20c.5 0 .9-.5.9-1.2v-1.2c0-.5-.4-.9-.9-.9h-2.3V7.5c0-.9.7-1.7 1.6-1.7z"/></svg>
                                            </div>
                                            <span>X (推特)</span>
                                        </button>

                                        <!-- 8. 小红书 -->
                                        <button id="xhs-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-red-400 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M4 19.5V15A4.5 4.5 0 0 1 8.5 10.5H15A4.5 4.5 0 0 1 19.5 15V19.5a.5.5 0 0 1-.5.5H5a.5.5 0 0 1-.5-.5z"/><path d="M8 10h8m-8 4h8M4 5h16M12 5v15"/></svg>
                                            </div>
                                            <span>小红书</span>
                                        </button>

                                        <!-- ROW 3 -->
                                        <!-- 9. ins (Instagram) -->
                                        <button id="ins-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-gradient-to-tr from-yellow-400 via-pink-500 to-purple-600 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="2" width="20" height="20" rx="5" ry="5"></rect><path d="M16 11.37A4 4 0 1 1 11.37 16 4 4 0 0 1 16 11.37z"></path><line x1="17.5" y1="6.5" x2="17.5" y2="6.5"></line></svg>
                                            </div>
                                            <span>ins</span>
                                        </button>

                                        <!-- 10. 淘宝 -->
                                        <button id="taobao-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-orange-500 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M6 2L3 6v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V6l-3-4z"/><path d="M3 6h18"/><path d="M16 10a4 4 0 0 1-4 4h0a4 4 0 0 1-4-4"/></svg>
                                            </div>
                                            <span>淘宝</span>
                                        </button>

                                        <!-- 11. 贴吧 -->
                                        <button id="tieba-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-blue-600 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"/><circle cx="9" cy="7" r="4"/><path d="M23 21v-2a4 4 0 0 0-3-3.87"/><path d="M16 3.13a4 4 0 0 1 0 7.75"/></svg>
                                            </div>
                                            <span>贴吧</span>
                                        </button>
                                        
                                        <!-- 12. 地图 -->
                                        <button id="map-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-green-600 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="1 6 1 22 8 18 16 22 23 18 23 2 16 6 8 2 1 6"></polygon><line x1="16" y1="2" x2="16" y2="22"></line><line x1="8" y1="2" x2="8" y2="18"></line></svg>
                                            </div>
                                            <span>地图</span>
                                        </button>

                                        <!-- ROW 4 -->
                                        <!-- 13. 直播 -->
                                        <button id="live-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-red-700 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M16 16v1a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2v-3a2 2 0 0 1 2-2h14l4 4-4 4z"></path></svg>
                                            </div>
                                            <span>直播</span>
                                        </button>
                                        
                                        <!-- 14. 微博 -->
                                        <button id="weibo-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-yellow-600 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2h12v4M18 4h-2M15 4a3 3 0 0 0 0 6H4M22 17V8a2 2 0 0 0-2-2h-3M18 10l-4 4"/></svg>
                                            </div>
                                            <span>微博</span>
                                        </button>

                                         <!-- 15. 备忘录 -->
                                        <button id="memo-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-lime-500 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"/><polyline points="14 2 14 8 20 8"/><line x1="16" y1="13" x2="8" y2="13"/><line x1="16" y1="17" x2="8" y2="17"/><line x1="10" y1="9" x2="8" y2="9"/></svg>
                                            </div>
                                            <span>备忘录</span>
                                        </button>

                                        <!-- 16. 主题 -->
                                        <button id="theme-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-purple-500 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/><circle cx="12" cy="12" r="3"/><path d="M16 8l-2 2M8 8l2 2"/></svg>
                                            </div>
                                            <span>主题</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                            <!-- PAGE 2: 主屏幕第二页 (新增) -->
                            <div id="page-2" class="w-1/2 h-full flex flex-col p-4 pt-8">
                                <div class="flex-grow app-grid-area overflow-y-auto">
                                    <!-- 新增应用图标网格 -->
                                    <div class="grid grid-cols-4 gap-y-6 pt-4">
                                        <!-- 17. 文件夹 -->
                                        <button id="folder-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-gray-400 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 19a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h5l2 3h9a2 2 0 0 1 2 2z"></path></svg>
                                            </div>
                                            <span>文件夹</span>
                                        </button>
                                        <!-- 18. 计算器 -->
                                        <button id="calculator-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-gray-700 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="2" width="16" height="20" rx="2" ry="2"></rect><line x1="8" y1="6" x2="16" y2="6"></line><line x1="8" y1="10" x2="16" y2="10"></line><line x1="8" y1="14" x2="16" y2="14"></line><line x1="8" y1="18" x2="16" y2="18"></line></svg>
                                            </div>
                                            <span>计算器</span>
                                        </button>
                                         <!-- 19. 时钟 -->
                                         <button id="clock-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-orange-600 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>
                                            </div>
                                            <span>时钟</span>
                                        </button>
                                         <!-- 20. 天气 -->
                                         <button id="weather-app-icon" class="flex flex-col items-center space-y-1 text-xs text-white app-icon-btn">
                                            <div class="w-12 h-12 bg-blue-400 rounded-xl shadow-lg flex items-center justify-center">
                                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2a10 10 0 0 0-8 4 10 10 0 0 0 8 4 10 10 0 0 0 8-4 10 10 0 0 0-8-4z"></path><path d="M16 17a5 5 0 0 0-8 0"></path></svg>
                                            </div>
                                            <span>天气</span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                        
                        <!-- Pagination Dots (Fixed overlay above page container) -->
                        <div id="pagination-indicator" class="absolute bottom-2 left-0 right-0 flex justify-center space-x-2 pb-2">
                            <div id="dot-1" class="w-2 h-2 rounded-full bg-white transition-opacity duration-300 opacity-100"></div>
                            <div id="dot-2" class="w-2 h-2 rounded-full bg-white transition-opacity duration-300 opacity-50"></div>
                        </div>
                    </div>
                    <!-- END SWIPEABLE PAGE CONTAINER -->
                    
                    <!-- C. Dock/Navigation Bar (底部导航栏) -->
                    <div class="flex-shrink-0 h-16 bg-white/30 backdrop-blur-md rounded-3xl p-3 mx-4 flex justify-around items-center shadow-2xl">
                        <!-- 电话 -->
                        <button class="dock-icon-btn p-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M22 16.92v3a2 2 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-5.65-5.65 19.79 19.79 0 0 1-3.07-8.63A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"></path></svg>
                        </button>
                        <!-- 微信/聊天 -->
                        <button class="dock-icon-btn p-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path></svg>
                        </button>
                        <!-- 拍照 -->
                        <button class="dock-icon-btn p-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"></path><circle cx="12" cy="13" r="4"></circle></svg>
                        </button>
                        <!-- 浏览器 -->
                        <button class="dock-icon-btn p-1">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-7 h-7 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="10"></circle><line x1="2" y1="12" x2="22" y2="22"></line><path d="M12 2a15.3 15.3 0 0 1 4 10 15.3 15.3 0 0 1-4 10 15.3 15.3 0 0 1-4-10 15.3 15.3 0 0 1 4-10z"></path></svg>
                        </button>
                    </div>

                    <!-- D. Home Indicator (Home 栏) -->
                    <div id="home-indicator-container" class="absolute bottom-0 left-0 right-0 h-4 flex-shrink-0 flex items-center justify-center pb-2 z-60 cursor-pointer">
                        <div class="h-1.5 w-32 rounded-full bg-white/80 shadow-lg" style="box-shadow: 0 0 8px rgba(255, 255, 255, 0.4);"></div>
                    </div>
                </div>
                
                <!-- 锁屏开屏层 - 始终填充整个屏幕 -->
                <div id="lock-screen" class="absolute inset-0 z-50 bg-gray-900/95 backdrop-blur-sm flex flex-col items-center justify-center transition-all duration-500 ease-in-out cursor-grab">
                    <div class="text-center">
                        <!-- 锁图标 -->
                        <svg xmlns="http://www.w3.org/2000/svg" width="64" height="64" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="w-16 h-16 text-indigo-400 mx-auto mb-10">
                            <rect x="3" y="11" width="18" height="11" rx="2" ry="2"></rect>
                            <path d="M7 11V7a5 5 0 0 1 10 0v4"></path>
                        </svg>

                        <p class="text-2xl font-light text-white mb-10 tracking-wider">
                            滑动解锁
                        </p>

                        <!-- MODIFIED: Horizontal Unlock Slider -->
                        <div class="unlock-area mx-auto" id="unlockArea">
                            <div class="unlock-handle" id="unlockHandle">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polyline points="9 10 14 15 9 20"/></svg>
                            </div>
                        </div>
                        <!-- END MODIFIED -->
                    </div>
                </div>
                
                <!-- Notification/Control Center Panel -->
                <div id="notification-center" class="absolute inset-0 z-40 bg-gray-900/95 backdrop-blur-md flex flex-col pt-8 px-4" style="transform: translateY(-100%);">
                    <div class="flex justify-between items-center mb-6">
                        <h2 class="text-3xl font-bold text-white">通知中心</h2>
                        <span id="notification-date" class="text-sm text-gray-400"></span>
                    </div>

                    <!-- Quick Toggles Grid -->
                    <div class="grid grid-cols-4 gap-4 mb-8">
                        <!-- Wi-Fi Toggle -->
                        <div class="flex flex-col items-center space-y-1">
                            <button class="w-12 h-12 bg-indigo-500 rounded-full flex items-center justify-center toggle-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M5 12.55C6.39 10.97 8.5 10 12 10s5.61.97 7 2.55M12 20V10M17 15l-5 5-5-5"/></svg>
                            </button>
                            <span class="text-xs text-white w-full text-center">Wi-Fi</span>
                        </div>
                        
                        <!-- Bluetooth Toggle -->
                        <div class="flex flex-col items-center space-y-1">
                            <button id="bluetooth-toggle" 
                                    class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center toggle-btn"
                                    ontouchstart="startPress(event, 'bluetooth')"
                                    ontouchend="endPress(event, 'bluetooth')"
                                    onmousedown="startPress(event, 'bluetooth')"
                                    onmouseup="endPress(event, 'bluetooth')">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M7 11L17 5L12 12L17 19L7 13L12 12"/></svg>
                            </button>
                            <span id="bluetooth-status-text" class="text-xs text-gray-300 w-full text-center">蓝牙</span>
                        </div>
                        
                        <!-- Rotation Lock -->
                        <div class="flex flex-col items-center space-y-1">
                            <button class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center toggle-btn">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2v2M22 12h-2M4 12H2M19 19L17 17M7 7L5 5M12 22a10 10 0 1 0 0-20 10 10 0 0 0 0 20z"/></svg>
                            </button>
                            <span class="text-xs text-gray-300 w-full text-center">旋转</span>
                        </div>
                        <!-- Flashlight -->
                        <div class="flex flex-col items-center space-y-1">
                            <button id="flashlight-toggle" 
                                    class="w-12 h-12 bg-white/20 rounded-full flex items-center justify-center toggle-btn"
                                    ontouchstart="startPress(event, 'flashlight')"
                                    ontouchend="endPress(event, 'flashlight')"
                                    onmousedown="startPress(event, 'flashlight')"
                                    onmouseup="endPress(event, 'flashlight')">
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 text-white" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M15 12V3H9V12L5 16H8L9 21H15L16 16H19L15 12Z"/></svg>
                            </button>
                            <span id="flashlight-status-text" class="text-xs text-gray-300 w-full text-center">手电筒</span>
                        </div>
                    </div>

                    <!-- Brightness Slider -->
                    <div id="brightness-container" class="mb-8 p-3 bg-white/10 rounded-xl">
                        <label class="text-white text-sm block mb-1">亮度调节</label>
                        <div class="flex items-center space-x-2">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 text-gray-400" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg>
                            <input id="brightness-slider" type="range" class="w-full h-1 bg-gray-600 rounded-lg appearance-none cursor-pointer range-lg" min="0" max="100" value="70">
                        </div>
                    </div>

                    <!-- Notifications Placeholder -->
                    <div id="notification-list-container" class="flex-grow overflow-y-auto">
                        <div id="active-notifications" class="space-y-3">
                            <div class="bg-gray-700/50 p-3 rounded-xl" id="notif-1">
                                <p class="text-sm font-semibold text-white">微信</p>
                                <p class="text-xs text-gray-300">新消息: 收到 1 条未读信息。</p>
                            </div>
                            <div class="bg-gray-700/50 p-3 rounded-xl" id="notif-2">
                                <p class="text-sm font-semibold text-white">系统</p>
                                <p class="text-xs text-gray-300">系统更新可在设置中进行。</p>
                            </div>
                            <!-- Filler notifications to make it look scrollable -->
                            <div class="bg-gray-700/50 p-3 rounded-xl" id="notif-3">
                                <p class="text-sm font-semibold text-white">浏览器</p>
                                <p class="text-xs text-gray-300">最新 Gemini 更新：现已支持图像生成。</p>
                            </div>
                            <div class="bg-gray-700/50 p-3 rounded-xl" id="notif-4">
                                <p class="text-sm font-semibold text-white">日历</p>
                                <p class="text-xs text-gray-300">提醒: 下午 2 点有线上会议。</p>
                            </div>
                        </div>

                        <!-- NEW: Clear All Notifications Button at the bottom of the list container (Pill shape) -->
                        <div class="mt-4 mb-4 flex justify-center">
                            <button id="clear-all-notifications" 
                                    class="py-2 px-6 rounded-full text-white font-medium hover:bg-white/20 transition duration-150 toggle-btn bg-white/10" 
                                    title="清除全部通知">
                                <!-- Trash/Clear Icon -->
                                <svg xmlns="http://www.w3.org/2000/svg" class="w-5 h-5 inline-block mr-2" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><path d="M3 6h18"></path><path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6"></path><path d="M10 11v6"></path><path d="M14 11v6"></path><path d="M15 6V4a2 2 0 0 0-2-2h-2a2 2 0 0 0-2 2v2"></path></svg>
                                清除全部
                            </button>
                        </div>
                        
                        <!-- Message when no notifications -->
                        <div class="text-center mt-6 hidden" id="no-notifications-message">
                            <p class="text-sm text-gray-400">无更多通知</p>
                        </div>
                    </div>

                    <!-- Home Indicator in Notification Center -->
                    <div class="h-4 flex-shrink-0 flex items-center justify-center pb-2">
                        <div id="notif-home-indicator" class="h-1 w-32 rounded-full bg-gray-400/70 cursor-pointer"></div>
                    </div>
                </div>
                
                <!-- --- APP MODALS START HERE (Z-index 55-59) --- -->

                <!-- 1. AI 应用模态框 -->
                <div id="ai-app-modal" 
                    class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-indigo-600 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-indigo-200 transition" data-app-id="ai-app-modal" data-app-name="AI 宣言">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">AI 职业宣言</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <div class="bg-white p-6 rounded-xl shadow-lg">
                            <h3 class="text-2xl font-bold text-gray-800 mb-4 border-b pb-2">生成您的使命宣言</h3>
                            <p class="text-gray-600 mb-4">
                                基于预设的“前端开发爱好者 | 数字艺术家”简介，点击下方按钮，让 Gemini 为您生成一句有力的职业口号。
                            </p>
                            <div id="mission-statement-display-modal" class="mb-6 p-4 min-h-[60px] flex items-center justify-center bg-indigo-50 border-2 border-indigo-200 rounded-lg">
                                <p class="text-base text-gray-500 text-center">宣言将在此处显示...</p>
                            </div>
                            <button id="generate-mission-btn-modal" 
                                    class="w-full py-3 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 transition duration-300 shadow-md disabled:bg-indigo-400">
                                ✨ 运行 AI 生成
                            </button>
                        </div>
                    </div>
                </div>
                
                <!-- 2. 消息应用模态框 -->
                <div id="message-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-red-600 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-red-200 transition" data-app-id="message-app-modal" data-app-name="消息">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">消息</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <p class="text-center text-gray-500 mt-10">这是您的聊天记录界面。请等待新消息...</p>
                        <div class="space-y-3 mt-6">
                            <div class="bg-white p-3 rounded-lg shadow">
                                <p class="font-semibold text-gray-800">系统通知</p>
                                <p class="text-sm text-gray-500">欢迎使用模拟消息应用！</p>
                            </div>
                            <div class="bg-white p-3 rounded-lg shadow">
                                <p class="font-semibold text-gray-800">联系人 A</p>
                                <p class="text-sm text-gray-500">（占位符：最新回复）</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 3. 相册应用模态框 -->
                <div id="gallery-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-green-600 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-green-200 transition" data-app-id="gallery-app-modal" data-app-name="相册">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">相册</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-4 overflow-y-auto bg-gray-100">
                        <div class="grid grid-cols-3 gap-1">
                            <!-- Placeholder Images -->
                            <img src="https://placehold.co/120x120/4f46e5/ffffff/png?text=Pic+1" alt="Placeholder Image 1" class="w-full h-auto rounded-lg object-cover">
                            <img src="https://placehold.co/120x120/10b981/ffffff/png?text=Pic+2" alt="Placeholder Image 2" class="w-full h-auto rounded-lg object-cover">
                            <img src="https://placehold.co/120x120/f97316/ffffff/png?text=Pic+3" alt="Placeholder Image 3" class="w-full h-auto rounded-lg object-cover">
                            <img src="https://placehold.co/120x120/ef4444/ffffff/png?text=Pic+4" alt="Placeholder Image 4" class="w-full h-auto rounded-lg object-cover">
                            <img src="https://placehold.co/120x120/e879f9/ffffff/png?text=Pic+5" alt="Placeholder Image 5" class="w-full h-auto rounded-lg object-cover">
                            <img src="https://placehold.co/120x120/60a5fa/ffffff/png?text=Pic+6" alt="Placeholder Image 6" class="w-full h-auto rounded-lg object-cover">
                        </div>
                        <p class="text-center text-gray-500 mt-4 text-sm">您的精彩瞬间</p>
                    </div>
                </div>

                <!-- 4. 设置应用模态框 -->
                <div id="settings-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-gray-700 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-gray-400 transition" data-app-id="settings-app-modal" data-app-name="设置">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">设置</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-white">
                        <ul class="space-y-4">
                            <li class="p-3 bg-gray-100 rounded-lg flex justify-between items-center shadow-sm">
                                <span class="font-medium text-gray-800">Wi-Fi & 网络</span>
                                <span class="text-sm text-indigo-600">已连接</span>
                            </li>
                            <li class="p-3 bg-gray-100 rounded-lg flex justify-between items-center shadow-sm">
                                <span class="font-medium text-gray-800">显示与亮度</span>
                                <span class="text-sm text-gray-500">70%</span>
                            </li>
                            <li class="p-3 bg-gray-100 rounded-lg flex justify-between items-center shadow-sm">
                                <span class="font-medium text-gray-800">系统更新</span>
                                <span class="text-sm text-red-500 font-bold">有可用更新</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- 5. 浏览器应用模态框 -->
                <div id="browser-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-yellow-600 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-yellow-200 transition" data-app-id="browser-app-modal" data-app-name="浏览器">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">浏览器</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <div class="bg-white p-4 rounded-xl shadow-lg">
                            <h3 class="text-lg font-bold text-gray-800 mb-2">欢迎使用模拟浏览器</h3>
                            <p class="text-sm text-gray-600">这是您的起始页。搜索或输入网址开始浏览。</p>
                            <div class="mt-4 flex space-x-2">
                                <button class="flex-1 py-2 bg-indigo-500 text-white rounded-lg text-sm">搜索</button>
                                <button class="flex-1 py-2 bg-gray-200 text-gray-700 rounded-lg text-sm">历史记录</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 6. 音乐应用模态框 -->
                <div id="music-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-pink-600 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-pink-200 transition" data-app-id="music-app-modal" data-app-name="音乐">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">音乐</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <div class="bg-white p-6 rounded-xl shadow-lg text-center">
                            <img src="https://placehold.co/150x150/d1d5db/ffffff/png?text=Album+Art" alt="Album+Art" class="mx-auto rounded-xl shadow-md mb-4">
                            <p class="text-2xl font-bold text-gray-800">模拟歌曲名称</p>
                            <p class="text-lg text-gray-600">模拟艺术家</p>
                            <div class="mt-6 flex justify-center items-center space-x-6">
                                <button class="text-gray-700 hover:text-pink-600 transition"><svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="19 20 9 12 19 4 19 20"></polygon><line x1="5" y1="19" x2="5" y2="5"></line></svg></button>
                                <button class="text-pink-600 hover:text-pink-800 transition"><svg xmlns="http://www.w3.org/2000/svg" class="w-12 h-12" viewBox="0 0 24 24" fill="currentColor"><circle cx="12" cy="12" r="10"></circle><path d="M10 8l6 4-6 4V8z" fill="white"></path></svg></button>
                                <button class="text-gray-700 hover:text-pink-600 transition"><svg xmlns="http://www.w3.org/2000/svg" class="w-8 h-8" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><polygon points="5 4 15 12 5 20 5 4"></polygon><line x1="19" y1="5" x2="19" y2="19"></line></svg></button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 7. X (Twitter) 应用模态框 -->
                <div id="x-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-black text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-gray-300 transition" data-app-id="x-app-modal" data-app-name="X (推特)">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">X (推特)</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <p class="text-center text-gray-500 mt-10">欢迎来到 X！这是一个实时信息流的占位符。</p>
                        <div class="mt-6 space-y-4">
                            <div class="bg-white p-4 rounded-xl shadow">
                                <p class="font-semibold text-gray-800">@GeminiDev</p>
                                <p class="text-sm text-gray-600">模拟发布：AI 手机界面交互已完成 90%！丝滑体验即将上线。#UIUX</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 8. 小红书应用模态框 -->
                <div id="xhs-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-red-400 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-red-200 transition" data-app-id="xhs-app-modal" data-app-name="小红书">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">小红书</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <p class="text-center text-gray-500 mt-10">探索美好生活！这是一个双列瀑布流的占位符。</p>
                        <div class="grid grid-cols-2 gap-3 mt-4">
                            <div class="bg-white rounded-xl shadow overflow-hidden">
                                <img src="https://placehold.co/150x200/f87171/ffffff/png?text=Fashion" alt="Fashion Post" class="w-full h-auto">
                                <p class="p-2 text-xs text-gray-600">今日穿搭分享！</p>
                            </div>
                            <div class="bg-white rounded-xl shadow overflow-hidden">
                                <img src="https://placehold.co/150x250/22c55e/ffffff/png?text=Travel" alt="Travel Post" class="w-full h-auto">
                                <p class="p-2 text-xs text-gray-600">周末户外探店攻略！</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 9. ins (Instagram) 应用模态框 -->
                <div id="ins-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-pink-600 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-pink-200 transition" data-app-id="ins-app-modal" data-app-name="Instagram">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">Instagram</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <p class="text-center text-gray-500 mt-10">分享你的精彩瞬间！这是图片 Feed 占位符。</p>
                        <div class="mt-6 space-y-4">
                            <div class="bg-white rounded-xl shadow">
                                <img src="https://placehold.co/400x300/f59e0b/ffffff/png?text=Story" alt="Image Post" class="w-full h-auto rounded-t-xl">
                                <div class="p-3">
                                    <p class="font-semibold">@User_A</p>
                                    <p class="text-sm text-gray-600">新照片发布：阳光下的咖啡 ☕</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 10. 淘宝应用模态框 -->
                <div id="taobao-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-orange-500 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-orange-200 transition" data-app-id="taobao-app-modal" data-app-name="淘宝">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">淘宝</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <p class="text-center text-gray-500 mt-10">万能的淘宝！这是商品列表占位符。</p>
                        <div class="mt-6 space-y-4">
                            <div class="bg-white p-3 rounded-xl shadow flex items-center">
                                <img src="https://placehold.co/60x60/f97316/ffffff/png?text=Item" alt="Product" class="rounded-lg mr-4">
                                <div>
                                    <p class="font-semibold text-gray-800">商品名称：智能手机壳</p>
                                    <p class="text-red-500 font-bold">¥ 49.90</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 11. 贴吧应用模态框 -->
                <div id="tieba-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-blue-600 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-blue-200 transition" data-app-id="tieba-app-modal" data-app-name="贴吧">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">贴吧</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <p class="text-center text-gray-500 mt-10">兴趣交友社区！这是热门帖子占位符。</p>
                        <div class="mt-6 space-y-4">
                            <div class="bg-white p-4 rounded-xl shadow">
                                <p class="font-semibold text-gray-800">#手机模拟吧</p>
                                <p class="text-sm text-gray-600">主题：有没有人觉得新版的交互更丝滑了？</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 12. 地图应用模态框 -->
                <div id="map-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-green-600 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-green-200 transition" data-app-id="map-app-modal" data-app-name="地图">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">地图</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-0 overflow-hidden bg-gray-100 relative">
                        <div class="absolute inset-0 flex items-center justify-center bg-green-200">
                            <p class="text-xl text-green-700 font-bold">地图加载中...</p>
                        </div>
                        <div class="p-4 absolute bottom-0 w-full bg-white/90 backdrop-blur-sm shadow-lg">
                             <p class="text-sm text-gray-700">当前位置：北京，距离目的地 $1.5$ km</p>
                        </div>
                    </div>
                </div>

                <!-- 13. 直播应用模态框 -->
                <div id="live-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-red-700 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-red-300 transition" data-app-id="live-app-modal" data-app-name="直播">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">直播</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-0 overflow-hidden bg-black relative">
                        <div class="absolute inset-0 flex items-center justify-center">
                            <span class="text-red-500 text-2xl animate-pulse">🔴 LIVE...</span>
                        </div>
                        <div class="p-3 absolute bottom-0 w-full bg-black/50 text-white">
                             <p class="text-sm">主播：AI 界面设计师</p>
                             <p class="text-xs text-gray-300">观众：999+</p>
                        </div>
                    </div>
                </div>
                
                <!-- 14. 微博应用模态框 -->
                <div id="weibo-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-yellow-600 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-yellow-200 transition" data-app-id="weibo-app-modal" data-app-name="微博">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">微博</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <p class="text-center text-gray-500 mt-10">随时随地发现新鲜事！这是热门话题占位符。</p>
                        <div class="mt-6 space-y-4">
                            <div class="bg-white p-4 rounded-xl shadow">
                                <p class="font-semibold text-gray-800">#AI交互新趋势</p>
                                <p class="text-sm text-gray-600">讨论：未来手机界面应如何进化？</p>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 15. 备忘录应用模态框 -->
                <div id="memo-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-lime-500 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-lime-200 transition" data-app-id="memo-app-modal" data-app-name="备忘录">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">备忘录</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-white">
                        <ul class="space-y-3">
                            <li class="p-3 bg-lime-50 rounded-lg border-l-4 border-lime-600 shadow-sm">
                                <p class="font-medium text-gray-800">🛒 购买清单：牛奶、鸡蛋、面包。</p>
                            </li>
                            <li class="p-3 bg-lime-50 rounded-lg border-l-4 border-lime-600 shadow-sm">
                                <p class="font-medium text-gray-800">💡 交互灵感：尝试多点触控手势。</p>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- 16. 主题应用模态框 -->
                <div id="theme-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-purple-500 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-purple-200 transition" data-app-id="theme-app-modal" data-app-name="主题">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">主题</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <p class="text-center text-gray-500 mt-10">个性化你的手机！这是主题选择占位符。</p>
                        <div class="mt-6 space-y-4">
                            <div class="p-4 bg-white rounded-xl shadow text-center">
                                <p class="font-bold text-gray-800">当前主题: 极简深色</p>
                                <button class="mt-3 py-2 px-4 bg-purple-600 text-white rounded-lg text-sm hover:bg-purple-700 transition">切换主题</button>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- 17. 文件夹应用模态框 (新增) -->
                <div id="folder-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-gray-500 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-gray-200 transition" data-app-id="folder-app-modal" data-app-name="文件夹">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">文件夹</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <p class="text-center text-gray-500 mt-10">模拟文件管理器界面。</p>
                        <ul class="space-y-3 mt-6">
                            <li class="p-3 bg-white rounded-lg shadow flex justify-between items-center">
                                <span class="font-medium text-gray-800">📁 文档 (15)</span>
                            </li>
                            <li class="p-3 bg-white rounded-lg shadow flex justify-between items-center">
                                <span class="font-medium text-gray-800">🖼️ 图片 (240)</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- 18. 计算器应用模态框 (新增) -->
                <div id="calculator-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-gray-800 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-gray-400 transition" data-app-id="calculator-app-modal" data-app-name="计算器">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">计算器</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 flex flex-col justify-end bg-gray-900 text-white">
                        <div class="text-right text-4xl mb-4" id="calculator-display">0</div>
                        <div class="grid grid-cols-4 gap-2">
                            <button class="bg-gray-700/50 text-white p-4 rounded-full text-xl">AC</button>
                            <button class="bg-gray-700/50 text-white p-4 rounded-full text-xl">+/-</button>
                            <button class="bg-gray-700/50 text-white p-4 rounded-full text-xl">%</button>
                            <button class="bg-orange-500 text-white p-4 rounded-full text-xl">/</button>
                            
                            <button class="bg-gray-700 text-white p-4 rounded-full text-xl">7</button>
                            <button class="bg-gray-700 text-white p-4 rounded-full text-xl">8</button>
                            <button class="bg-gray-700 text-white p-4 rounded-full text-xl">9</button>
                            <button class="bg-orange-500 text-white p-4 rounded-full text-xl">x</button>

                            <button class="bg-gray-700 text-white p-4 rounded-full text-xl">4</button>
                            <button class="bg-gray-700 text-white p-4 rounded-full text-xl">5</button>
                            <button class="bg-gray-700 text-white p-4 rounded-full text-xl">6</button>
                            <button class="bg-orange-500 text-white p-4 rounded-full text-xl">-</button>

                            <button class="bg-gray-700 text-white p-4 rounded-full text-xl">1</button>
                            <button class="bg-gray-700 text-white p-4 rounded-full text-xl">2</button>
                            <button class="bg-gray-700 text-white p-4 rounded-full text-xl">3</button>
                            <button class="bg-orange-500 text-white p-4 rounded-full text-xl">+</button>

                            <button class="col-span-2 bg-gray-700 text-white p-4 rounded-full text-xl">0</button>
                            <button class="bg-gray-700 text-white p-4 rounded-full text-xl">.</button>
                            <button class="bg-orange-500 text-white p-4 rounded-full text-xl">=</button>
                        </div>
                    </div>
                </div>

                <!-- 19. 时钟应用模态框 (新增) -->
                <div id="clock-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-orange-600 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-orange-200 transition" data-app-id="clock-app-modal" data-app-name="时钟">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">时钟</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <p class="text-center text-6xl font-extrabold text-gray-800 mt-10" id="clock-time-display">--:--</p>
                        <p class="text-center text-gray-500 mt-2">（实时时钟模拟）</p>
                        <div class="mt-8 space-y-4">
                            <div class="p-3 bg-white rounded-xl shadow flex justify-between items-center">
                                <span class="font-medium text-gray-800">🌍 世界时钟: 东京</span>
                                <span class="text-gray-600">--:--</span>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- 20. 天气应用模态框 (新增) -->
                <div id="weather-app-modal" class="absolute inset-0 z-[55] bg-gray-50 flex flex-col app-modal">
                    <div class="flex-shrink-0 p-4 bg-blue-400 text-white shadow-md flex items-center justify-between">
                        <button class="close-app-btn text-lg font-medium hover:text-blue-100 transition" data-app-id="weather-app-modal" data-app-name="天气">
                            <svg xmlns="http://www.w3.org/2000/svg" class="w-6 h-6 inline-block mr-1" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="19" y1="12" x2="5" y2="12"></line><polyline points="12 19 5 12 12 5"></polyline></svg>
                            返回
                        </button>
                        <h2 class="text-xl font-bold">天气</h2>
                        <div class="w-16"></div>
                    </div>
                    <div class="flex-grow p-6 overflow-y-auto bg-gray-100">
                        <p class="text-center text-gray-500 mt-10">当前城市天气详情：</p>
                        <div class="mt-6 p-6 bg-white rounded-xl shadow-lg text-center">
                            <p class="text-4xl font-bold text-gray-800" id="weather-app-temp">22°C</p>
                            <p class="text-lg text-gray-600" id="weather-app-condition">晴朗</p>
                            <p class="text-sm text-gray-500 mt-1" id="weather-app-location">（定位位置）</p>
                            <img src="https://placehold.co/100x100/38bdf8/ffffff/png?text=☀️" alt="Weather Icon" class="mx-auto mt-4">
                        </div>
                    </div>
                </div>

                <!-- Bluetooth Configuration Modal (Bottom Sheet) -->
                <div id="bluetooth-config-modal" 
                    class="absolute bottom-0 left-0 right-0 z-[56] bg-gray-50 flex flex-col 
                            rounded-t-3xl shadow-2xl overflow-hidden" 
                    style="height: 70%; max-height: 500px;">
                    
                    <!-- Grabber/Handle -->
                    <div class="flex-shrink-0 p-3 flex justify-center border-b border-gray-200 bg-white">
                        <div class="w-10 h-1 bg-gray-300 rounded-full"></div>
                    </div>

                    <!-- Content -->
                    <div class="flex-grow p-6 overflow-y-auto bg-white">
                        <h3 class="text-2xl font-bold text-gray-800 mb-4">蓝牙设备</h3>
                        
                        <!-- Current Status: MODIFIED to use flex for left/right alignment -->
                        <div class="flex justify-between items-center mb-4 border-b pb-4 text-gray-600">
                            <!-- 左侧标签 -->
                            <span class="text-base font-medium">状态:</span>
                            <!-- 右侧状态值 -->
                            <span id="bluetooth-modal-status" class="font-semibold text-red-500 text-base">关闭</span>
                        </div>
                        
                        <!-- Search Button -->
                        <button id="start-bluetooth-scan"
                                class="w-full py-3 bg-indigo-600 text-white font-semibold rounded-xl hover:bg-indigo-700 transition duration-300 shadow-md disabled:bg-indigo-400 mb-6">
                            搜索可连接设备
                        </button>

                        <!-- Device List -->
                        <h4 class="text-lg font-bold text-gray-800 mb-3">可用设备</h4>
                        <ul id="available-devices-list" class="space-y-3">
                            <!-- Initial/Connected Device (Added class for exclusion from dynamic removal) -->
                            <li class="p-3 bg-indigo-50 rounded-lg flex justify-between items-center border border-indigo-200 initial-device">
                                <span class="font-medium text-indigo-800">My Gemini Headset</span>
                                <span class="text-sm text-indigo-600 font-bold" id="headset-status">未连接</span>
                            </li>
                            <li class="p-3 bg-gray-50 rounded-lg flex justify-between items-center border initial-device">
                                <span class="font-medium text-gray-800">Desktop Speaker</span>
                                <button class="text-indigo-600 text-sm font-medium hover:text-indigo-800">连接</button>
                            </li>
                        </ul>
                        
                        <!-- NEW: Close button based on user instruction -->
                        <button onclick="closeBluetoothConfig()" class="w-full py-3 bg-gray-600 text-white font-semibold rounded-xl hover:bg-gray-700 transition duration-300 shadow-md mt-6">
                            关闭
                        </button>
                        
                        <p class="text-center text-sm text-gray-400 mt-6">
                            长按或拖动 Home Indicator 关闭。
                        </p>
                    </div>
                </div>
                
            </div>
            
        </div>
    </div>

    <!-- JavaScript 逻辑 -->
    <script>
        const apiKey = ""; 
        const apiUrl = `https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`;

        // --- GLOBAL STATE VARIABLES ---
        let isEditMode = false;
        const HOME_LONG_PRESS_DURATION = 500; 
        let homePressTimer = null;
        let startPressX = 0; 
        let startPressY = 0;

        // --- NEW: Paging State Variables (FIX) ---
        let currentPage = 1; // Default to page 1
        const totalPages = 2;  // We have 2 pages (w-[200%])
        let isPagingSwiping = false;
        let pageDragStartX = 0;
        const pageSwipeThreshold = 50; // Min drag distance to trigger swipe

        /* --- REPLACED BLUETOOTH STATE & LOGIC --- */
        // 🔹 1. New State from User's Logic
        let isBluetoothOn = false;
        let pressTimer;
        let isLongPress = false;
        let dragStartY = 0; // 确保全局作用域 (Used by user's logic)

        // 🔹 2. Kept State from Old Logic (for UI helpers & connectRealBluetooth)
        let isBluetoothConnected = false; 
        let connectedDeviceName = "My Gemini Headset"; 
        let isScanning = false; // Keep for connectRealBluetooth
        
        
        // --- MOVED AND FIXED: Global Toast/Message Utility ---
        // ✅ 通用系统提示函数
        window.showMessage = function (message, color = "gray") {
          console.log(`[系统消息] ${message}`);

          // 如果页面上有 toast 容器，可以实际显示
          let toast = document.getElementById("system-toast");
          if (!toast) {
            toast = document.createElement("div");
            toast.id = "system-toast";
            toast.style.position = "fixed";
            toast.style.bottom = "20px";
            toast.style.left = "50%";
            toast.style.transform = "translateX(-50%)";
            toast.style.padding = "10px 16px";
            toast.style.borderRadius = "8px";
            toast.style.background = color;
            toast.style.color = "white";
            toast.style.fontSize = "14px";
            toast.style.zIndex = "9999";
            toast.style.transition = "opacity 0.3s ease";
            document.body.appendChild(toast);
          }

          toast.textContent = message;
          toast.style.opacity = "1";
          toast.style.background = color;

          setTimeout(() => {
            toast.style.opacity = "0";
          }, 1500);
        };
        // --- END MOVED AND FIXED FUNCTION ---


        // 🔹 3. REPLACED toggleBluetooth (As per user request)
        function toggleBluetooth() {
            if (isEditMode) return; // Keep edit mode check
            isBluetoothOn = !isBluetoothOn;
            
            // --- User's new logic ---
            const icon = document.getElementById('bluetooth-toggle');
            icon.classList.toggle('active', isBluetoothOn);
            showMessage(isBluetoothOn ? '蓝牙已开启' : '蓝牙已关闭', 'indigo');
            // --- End User's new logic ---

            // Also update the modal state if it's open
            updateBluetoothModalUI();
        }

        // 🔹 4. User's openBluetoothConfig (MERGED with existing UI calls)
        function openBluetoothConfig() {
            if (isEditMode) return; // Keep edit mode check
            
            const lockScreen = document.getElementById('lock-screen');
            const notificationCenter = document.getElementById('notification-center');
            const bluetoothConfigModal = document.getElementById('bluetooth-config-modal');

            if (lockScreen && lockScreen.style.display !== 'none') return;

            // Use existing helper
            if (notificationCenter && parseFloat(notificationCenter.style.transform.match(/(-?\d+(\.\d+)?)/)?.[0] || -100) > -100) {
                closeNotificationCenter();
            }

            updateBluetoothModalUI(); // Call existing modal UI update
            bluetoothConfigModal.classList.add('is-open');
            showMessage('蓝牙快速配置已打开', 'indigo');
        }

        // 🔹 5. User's closeBluetoothConfig (MERGED)
        function closeBluetoothConfig() {
            const bluetoothConfigModal = document.getElementById('bluetooth-config-modal');
            if (bluetoothConfigModal) { // Added check
                bluetoothConfigModal.classList.remove('is-open');
                bluetoothConfigModal.style.transform = '';
                showMessage('蓝牙配置已关闭', 'indigo');
            }
        }

        // 🔹 6. User's Press Handlers
        function startPress(event, target) {
            if (isEditMode) return;
            isLongPress = false;
            dragStartY = event.touches ? event.touches[0].clientY : event.clientY;

            if (event.type === 'touchstart') {
                 event.preventDefault(); // Prevent scrolling/zooming
            }

            pressTimer = setTimeout(() => {
                isLongPress = true;
                if (target === 'bluetooth') openBluetoothConfig();
            }, 700); // 700ms 
        }

        function endPress(event, target) {
            if (isEditMode) return;
            clearTimeout(pressTimer);
            if (!isLongPress) {
                // MODIFIED: As per user request, use switch
                switch (target) {
                    case 'bluetooth':
                        toggleBluetooth();
                        break;
                    case 'flashlight':
                        handleFlashlightToggle(); // Call flashlight function
                        break;
                    // 其他按钮...
                }
            }
            isLongPress = false; 
        }
        // --- END REPLACED LOGIC ---

        
        // --- Kept Bluetooth Helper Functions ---
        function updateBluetoothUI(isOn, isConnected = false, name = connectedDeviceName) {
            const btn = document.getElementById('bluetooth-toggle');
            const text = document.getElementById('bluetooth-status-text');

            btn.classList.remove('bg-indigo-500', 'bg-green-500', 'bg-white/20');
            text.classList.remove('text-white', 'text-gray-300');

            if (isOn) {
                if (isConnected) {
                    btn.classList.add('bg-green-500');
                    text.classList.add('text-white');
                    text.textContent = name.substring(0, 10) + (name.length > 10 ? '...' : ''); 
                } else {
                    btn.classList.add('bg-indigo-500');
                    text.classList.add('text-white');
                    text.textContent = '搜索中...';
                }
            } else {
                btn.classList.add('bg-white/20');
                text.classList.add('text-gray-300');
                text.textContent = '蓝牙';
            }
        }

        // (Old handleBluetoothToggle function is REMOVED)

        async function connectRealBluetooth() {
            if (!isBluetoothOn) {
                showMessage('请先开启蓝牙！', 'red');
                return false;
            }

            if (!navigator.bluetooth) {
                showMessage('此浏览器不支持 Web 蓝牙 API。', 'red');
                return false;
            }

            if (isScanning) return; 
            
            const startScanBtn = document.getElementById('start-bluetooth-scan');
            const list = document.getElementById('available-devices-list');

            isScanning = true;
            startScanBtn.disabled = true;
            startScanBtn.innerHTML = '<span class="animate-spin mr-2">⟳</span> 等待用户选择设备...';

            Array.from(list.children).forEach(child => {
                if (!child.classList.contains('initial-device')) {
                    child.remove();
                }
            });

            // --- REAL WEB BLUETOOTH API LOGIC ---
            try {
                // 1. 请求设备
                showMessage('请在浏览器弹窗中选择一个蓝牙设备...', 'indigo');
                const device = await navigator.bluetooth.requestDevice({
                    filters: [
                        { services: ['audio_input'] },
                        { services: ['audio_output'] },
                        { services: [0x180D] } // Heart Rate service (common demo)
                    ],
                    optionalServices: ['battery_service'], // 示例可选服务
                    acceptAllDevices: false // 如果过滤失败，可设为 true
                });
                
                const deviceName = device.name || '未知设备';
                showMessage(`正在连接到 ${deviceName}...`, 'indigo');

                // 2. (可选) 连接到 GATT 服务器
                // const server = await device.gatt.connect();
                // showMessage(`已连接到 ${deviceName} 的 GATT！`, 'green');

                // 3. 更新 UI
                const newDeviceLi = document.createElement('li');
                newDeviceLi.className = 'p-3 bg-green-100 rounded-lg flex justify-between items-center border border-green-300';
                newDeviceLi.innerHTML = `
                    <span class="font-medium text-green-800">${deviceName}</span>
                    <span class="text-sm text-green-600 font-bold">已连接</span>
                `;
                list.appendChild(newDeviceLi);

                // 4. (重要) 更新全局状态和主屏幕 UI
                isBluetoothConnected = true;
                connectedDeviceName = deviceName; // 更新连接的设备名称
                updateBluetoothUI(true, true, deviceName); // 更新通知中心图标
                updateBluetoothModalUI(); // 更新模态框状态

            } catch (error) {
                console.error('Web Bluetooth Error:', error);
                if (error.name === 'NotFoundError') {
                     showMessage('未选择设备或未找到设备。', 'yellow');
                } else if (error.name === 'NotAllowedError') {
                    showMessage('用户取消了设备选择。', 'yellow');
                } else {
                    showMessage('蓝牙连接失败。', 'red');
                }
            } finally {
                isScanning = false;
                startScanBtn.disabled = false;
                startScanBtn.textContent = '搜索可连接设备';
            }
            // --- END WEB BLUETOOTH API LOGIC ---
        }

        // --- Flashlight Logic Variables (Unchanged) ---
        // REMOVED: let isFlashlightOn = false; (No longer needed)

        // REMOVED: updateFlashlightUI() function (No longer called)

        // NEW: REPLACED handleFlashlightToggle (As per user request)
        function handleFlashlightToggle() {
            if (isEditMode) return; // Keep edit mode check
            
            // --- User's new logic ---
            const icon = document.getElementById('flashlight-toggle');
            if (!icon) return;
            icon.classList.toggle('active');
            const isActive = icon.classList.contains('active');
            showMessage(isActive ? '手电筒已开启' : '手电筒已关闭', 'amber');
            // --- End User's new logic ---
        }
        
        // NEW: Function provided by user (was missing)
        function generateMissionStatement() {
          console.log('[占位] generateMissionStatement() 被调用，但尚未实现');
          showMessage('任务中心功能尚未开放', 'gray');
        }

        // --- Bluetooth Config Modal Logic (Helpers) ---
        const bluetoothConfigModal = document.getElementById('bluetooth-config-modal');
        const bluetoothModalStatus = document.getElementById('bluetooth-modal-status');
        const headsetStatus = document.getElementById('headset-status');

        function updateBluetoothModalUI() {
            bluetoothModalStatus.classList.remove('text-red-500', 'text-indigo-500', 'text-green-500');
            headsetStatus.classList.remove('text-green-600', 'text-gray-500', 'text-indigo-600');

            if (isBluetoothOn) {
                if (isBluetoothConnected) {
                    bluetoothModalStatus.textContent = `已连接 (${connectedDeviceName})`;
                    bluetoothModalStatus.classList.add('text-green-500');
                    headsetStatus.textContent = '已连接';
                    headsetStatus.classList.add('text-green-600');
                } else {
                    bluetoothModalStatus.textContent = '开启 (搜索中)';
                    bluetoothModalStatus.classList.add('text-indigo-500');
                    headsetStatus.textContent = '未连接';
                    headsetStatus.classList.add('text-gray-500');
                }
            } else {
                bluetoothModalStatus.textContent = '关闭';
                bluetoothModalStatus.classList.add('text-red-500');
                headsetStatus.textContent = '未连接';
                headsetStatus.classList.add('text-gray-500');
            }
        }
        
        function closeNotificationCenter() {
            const notificationCenter = document.getElementById('notification-center');
            if (notificationCenter) {
                notificationCenter.style.transition = 'transform 0.25s ease-in-out';
                notificationCenter.style.transform = 'translateY(-100%)';
                showMessage('通知中心已关闭', 'indigo');
            }
        }

        // (Old openBluetoothConfig and closeBluetoothConfig functions are REMOVED)

        // --- Notification Clear Logic (Unchanged) ---
        function handleClearAllNotifications() {
            if (isEditMode) return;
            
            const activeNotifs = document.getElementById('active-notifications');
            const noNotifsMsg = document.getElementById('no-notifications-message');
            const clearBtn = document.getElementById('clear-all-notifications');

            activeNotifs.innerHTML = '';
            activeNotifs.classList.add('hidden');
            
            noNotifsMsg.classList.remove('hidden');
            clearBtn.classList.add('hidden');
            
            showMessage('全部通知已清除', 'yellow');
        }
        
        // --- App Modal Control (Generic) (Unchanged) ---

        function openApp(modalId, appName) {
            if (isEditMode) return;
            
            const modalElement = document.getElementById(modalId);
            const lockScreen = document.getElementById('lock-screen');
            const notificationCenter = document.getElementById('notification-center');

            if (lockScreen.style.display !== 'none' || !modalElement) return;

            if (parseFloat(notificationCenter.style.transform.match(/(-?\d+(\.\d+)?)/)?.[0] || -100) > -100) {
                closeNotificationCenter();
            }

            setTimeout(() => {
                modalElement.classList.add('is-open');
                modalElement.style.transition = 'transform 0.25s ease-in-out';
                showMessage(`${appName} 应用已启动`, 'indigo');
            }, 250); 
        }

        function closeApp(modalId, appName) {
            const modalElement = document.getElementById(modalId);
            if (modalElement) {
                modalElement.classList.remove('is-open');
                modalElement.style.transform = '';
                showMessage(`返回主屏幕`, 'indigo');
            }
        }

        // --- NEW PAGING LOGIC (Unchanged) ---

        function updatePaginationDots() {
            document.getElementById('dot-1').style.opacity = (currentPage === 1) ? 1 : 0.5;
            document.getElementById('dot-2').style.opacity = (currentPage === 2) ? 1 : 0.5;
        }

        function goToPage(pageIndex) {
            const container = document.getElementById('page-container');
            const innerScreen = document.getElementById('inner-screen');
            const pageWidth = innerScreen.offsetWidth;

            if (pageIndex < 1 || pageIndex > totalPages) return;

            currentPage = pageIndex;
            const translateX = -(currentPage - 1) * pageWidth;

            container.style.transition = 'transform 0.3s cubic-bezier(0.4, 0.0, 0.2, 1)'; // iOS-like fast curve
            container.style.transform = `translateX(${translateX}px)`;

            updatePaginationDots();
        }

        // --- Core Application Logic ---
        document.addEventListener('DOMContentLoaded', () => {
            const lockScreen = document.getElementById('lock-screen');
            const mainContent = document.getElementById('main-content');
            const innerScreen = document.getElementById('inner-screen');
            const pageContainer = document.getElementById('page-container');
            
            // Notification Center Elements
            const notificationCenter = document.getElementById('notification-center');
            const notifHomeIndicator = document.getElementById('notif-home-indicator');
            const bluetoothToggle = document.getElementById('bluetooth-toggle');
            const flashlightToggle = document.getElementById('flashlight-toggle'); // Variable definition is still needed
            const clearAllBtn = document.getElementById('clear-all-notifications');
            const startScanBtn = document.getElementById('start-bluetooth-scan');
            
            // --- Utility to toggle Edit Mode (Unchanged) ---
            function toggleEditMode(enable) {
                const appIcons = document.querySelectorAll('.app-icon-btn');
                const dockIcons = document.querySelectorAll('.dock-icon-btn');
                const dockContainer = document.querySelector('.flex-shrink-0.h-16.bg-white\\/30.backdrop-blur-md');

                if (enable) {
                    if (isEditMode) return;
                    isEditMode = true;
                    appIcons.forEach(icon => {
                        icon.classList.add('jiggle');
                        icon.disabled = true;
                    });
                    dockIcons.forEach(icon => {
                        icon.disabled = true;
                    });
                    dockContainer.classList.add('grayscale', 'opacity-70');
                    showMessage('进入编辑模式：轻触退出', 'yellow');
                } else {
                    if (!isEditMode) return;
                    isEditMode = false;
                    appIcons.forEach(icon => {
                        icon.classList.remove('jiggle');
                        icon.disabled = false;
                    });
                    dockIcons.forEach(icon => {
                        icon.disabled = false;
                    });
                    dockContainer.classList.remove('grayscale', 'opacity-70');
                    showMessage('退出编辑模式', 'indigo');
                }
            }


            // --- Event Listeners (Updated for new apps) ---
            // REMOVED: flashlightToggle.addEventListener('click', handleFlashlightToggle); 
            clearAllBtn.addEventListener('click', handleClearAllNotifications); 
            startScanBtn.addEventListener('click', connectRealBluetooth); 

            // 1. App Icon Click Listeners
            document.getElementById('message-app-icon').addEventListener('click', () => { openApp('message-app-modal', '消息'); });
            document.getElementById('gallery-app-icon').addEventListener('click', () => { openApp('gallery-app-modal', '相册'); });
            document.getElementById('settings-app-icon').addEventListener('click', () => { openApp('settings-app-modal', '设置'); });
            document.getElementById('browser-app-icon').addEventListener('click', () => { openApp('browser-app-modal', '浏览器'); });
            document.getElementById('music-app-icon').addEventListener('click', () => { openApp('music-app-modal', '音乐'); });
            document.getElementById('ai-app-icon').addEventListener('click', () => { openApp('ai-app-modal', 'AI 宣言'); });
            document.getElementById('x-app-icon').addEventListener('click', () => { openApp('x-app-modal', 'X (推特)'); });
            document.getElementById('xhs-app-icon').addEventListener('click', () => { openApp('xhs-app-modal', '小红书'); });
            document.getElementById('ins-app-icon').addEventListener('click', () => { openApp('ins-app-modal', 'Instagram'); });
            document.getElementById('taobao-app-icon').addEventListener('click', () => { openApp('taobao-app-modal', '淘宝'); });
            document.getElementById('tieba-app-icon').addEventListener('click', () => { openApp('tieba-app-modal', '贴吧'); });
            document.getElementById('map-app-icon').addEventListener('click', () => { openApp('map-app-modal', '地图'); });
            document.getElementById('live-app-icon').addEventListener('click', () => { openApp('live-app-modal', '直播'); });
            document.getElementById('weibo-app-icon').addEventListener('click', () => { openApp('weibo-app-modal', '微博'); });
            document.getElementById('memo-app-icon').addEventListener('click', () => { openApp('memo-app-modal', '备忘录'); });
            document.getElementById('theme-app-icon').addEventListener('click', () => { openApp('theme-app-modal', '主题'); });

            // NEW APP LISTENERS (Page 2)
            document.getElementById('folder-app-icon').addEventListener('click', () => { openApp('folder-app-modal', '文件夹'); });
            document.getElementById('calculator-app-icon').addEventListener('click', () => { openApp('calculator-app-modal', '计算器'); });
            document.getElementById('clock-app-icon').addEventListener('click', () => { openApp('clock-app-modal', '时钟'); });
            document.getElementById('weather-app-icon').addEventListener('click', () => { openApp('weather-app-modal', '天气'); });


            // 2. App Close Button Listeners (Unchanged)
            document.querySelectorAll('.close-app-btn').forEach(button => {
                button.addEventListener('click', (e) => {
                    const modalId = e.currentTarget.getAttribute('data-app-id');
                    const appName = e.currentTarget.getAttribute('data-app-name');
                    closeApp(modalId, appName);
                });
            });
            
            // 3. AI App Specific Listener (Unchanged)
            document.getElementById('generate-mission-btn-modal').addEventListener('click', generateMissionStatement);

            // 4. Home Indicator Click Listener (Unchanged)
            const homeIndicator = document.getElementById('home-indicator-container');
            homeIndicator.addEventListener('click', () => {
                if (isEditMode) {
                    toggleEditMode(false);
                    return;
                }
                
                const activeModal = Array.from(document.querySelectorAll('.app-modal.is-open, #bluetooth-config-modal.is-open'))
                    .find(modal => modal); 

                let didCloseSomething = false;

                if (activeModal) {
                    didCloseSomething = true;
                    if (activeModal.classList.contains('app-modal')) {
                        const modalId = activeModal.id;
                        const closeButton = document.querySelector(`.close-app-btn[data-app-id="${modalId}"]`);
                        const appName = closeButton ? closeButton.getAttribute('data-app-name') : 'App';
                        closeApp(modalId, appName);
                    } 
                    else if (activeModal.id === 'bluetooth-config-modal') {
                        closeBluetoothConfig();
                    }
                }
                
                const isNotifFullyOpen = parseFloat(notificationCenter.style.transform.match(/(-?\d+(\.\d+)?)/)?.[0] || 0) === 0;
                if (isNotifFullyOpen) {
                    didCloseSomething = true;
                    closeNotificationCenter();
                }

                const indicatorBar = homeIndicator.querySelector('div');
                if (indicatorBar && didCloseSomething) {
                    indicatorBar.classList.add('animate-pop');
                    setTimeout(() => {
                        indicatorBar.classList.remove('animate-pop');
                    }, 200);
                }
            });


            // --- Status Bar Logic (Unchanged) ---
            
            const BEIJING_LAT = 39.9042;
            const BEIJING_LON = 116.4074;
            // Helper to convert WMO code to description (simplified)
            function getWeatherCondition(code) {
                if (code >= 80) return '阵雨';
                if (code >= 71) return '下雪';
                if (code >= 61) return '降雨';
                if (code >= 51) return '细雨';
                if (code >= 45) return '有雾';
                if (code >= 3) return '多云';
                if (code >= 1) return '晴朗';
                return '未知';
            }

            async function updateWeather(lat, lon) {
                const statusWeatherEl = document.querySelector(".status-weather");
                const widgetTempEl = document.getElementById('widget-temp-display');
                const widgetLocationEl = document.getElementById('widget-location-display');
                const appTempEl = document.getElementById('weather-app-temp');
                const appConditionEl = document.getElementById('weather-app-condition');
                const appLocationEl = document.getElementById('weather-app-location');


                if (!statusWeatherEl || !widgetTempEl || !widgetLocationEl) return;
                
                try {
                    const url = `https://api.open-meteo.com/v1/forecast?latitude=${lat}&longitude=${lon}&current_weather=true`;
                    const res = await fetch(url);
                    const data = await res.json();
                    
                    const temp = Math.round(data.current_weather.temperature);
                    const weatherCode = data.current_weather.weathercode;
                    const condition = getWeatherCondition(weatherCode);

                    // Status Bar Update
                    statusWeatherEl.textContent = `${temp}°C`;

                    // Widget Update
                    widgetTempEl.textContent = `${temp}°C`;
                    const isBeijingFallback = (Math.abs(lat - BEIJING_LAT) < 0.01 && Math.abs(lon - BEIJING_LON) < 0.01);
                    const locationText = isBeijingFallback ? '北京' : '定位位置';
                    widgetLocationEl.textContent = `${condition}, ${locationText}`;

                    // App Modal Update
                    if (appTempEl) appTempEl.textContent = `${temp}°C`;
                    if (appConditionEl) appConditionEl.textContent = condition;
                    if (appLocationEl) appLocationEl.textContent = `当前城市: ${locationText}`;


                } catch (err) {
                    console.warn("Weather fetch failed:", err);
                    statusWeatherEl.textContent = "N/A";
                    widgetTempEl.textContent = "N/A";
                    widgetLocationEl.textContent = "无法获取位置";
                }
            }

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (pos) => {
                        updateWeather(pos.coords.latitude, pos.coords.longitude);
                    },
                    () => updateWeather(BEIJING_LAT, BEIJING_LON) // fallback: Beijing
                );
            } else {
                updateWeather(BEIJING_LAT, BEIJING_LON);
            }

            function updateClock() {
                const now = new Date();
                const h = String(now.getHours()).padStart(2, "0");
                const m = String(now.getMinutes()).padStart(2, "0");
                const s = String(now.getSeconds()).padStart(2, "0");
                
                // Status Bar Time
                const statusTimeEl = document.querySelector(".status-time");
                if (statusTimeEl) statusTimeEl.textContent = `${h}:${m}`;

                // Widget Time/Date Synchronization
                const widgetTimeElement = document.getElementById('widget-time');
                const widgetDateElement = document.getElementById('widget-date');
                const notificationDate = document.getElementById('notification-date');
                
                if (widgetTimeElement) widgetTimeElement.textContent = `${h}:${m}`;
                if (widgetDateElement) widgetDateElement.textContent = now.toLocaleDateString('zh-CN', { weekday: 'short', month: 'long', day: 'numeric' });
                
                // Notification Center Date Synchronization
                const options = { month: 'long', day: 'numeric', weekday: 'long' };
                if (notificationDate) notificationDate.textContent = now.toLocaleDateString('zh-CN', options);

                // Clock App
                const clockAppDisplay = document.getElementById('clock-time-display');
                if (clockAppDisplay) clockAppDisplay.textContent = `${h}:${m}:${s}`;
            }
            setInterval(updateClock, 1000);
            updateClock();

            // ... (Network & Battery logic remains unchanged) ...
            // (omitted for brevity, assume they are included)

            // --- Unlock Logic (Modified) ---
            function unlockScreen() { 
                lockScreen.style.transition = 'transform 0.5s ease-out';
                lockScreen.style.transform = 'translateY(-100%)';
                mainContent.style.transform = 'scale(1)';
                mainContent.style.filter = 'blur(0)';

                setTimeout(() => {
                    lockScreen.style.display = 'none';
                    lockScreen.style.removeProperty('transform'); 
                    lockScreen.style.removeProperty('transition');
                    showMessage('屏幕已解锁！', 'green');
                }, 500);
            }
            
            // Slide-to-Unlock Logic variables and functions
            const unlockArea = document.getElementById("unlockArea");
            const unlockHandle = document.getElementById("unlockHandle");
            const max = unlockArea.offsetWidth - unlockHandle.offsetWidth;
            let startX = 0, currentX = 0, dragging = false;
            const getX = (e) => e.touches ? e.touches[0].clientX : e.clientX;
            const start = (e) => {
                 if (lockScreen.style.display === 'none') return;
                 const clientX = getX(e);
                 currentX = parseFloat(unlockHandle.style.left || '0px');
                 startX = clientX - currentX; 
                 dragging = true;
                 unlockHandle.style.transition = "none";
                 if (e.type === 'touchstart' && e.target.closest('#unlockHandle')) { e.preventDefault(); }
            };
            const move = (e) => {
                 if (!dragging) return;
                 const clientX = getX(e);
                 currentX = clientX - startX;
                 currentX = Math.max(0, Math.min(currentX, max));
                 unlockHandle.style.left = `${currentX}px`;
            };
            const end = () => {
                 if (!dragging) return;
                 dragging = false;
                 // FIX: Lowered required drag distance from 95% to 90%
                 if (currentX >= max * 0.90) { 
                    unlockHandle.style.left = `${max}px`;
                    unlockHandle.style.transition = "left 0.3s ease";
                    unlockScreen();
                 } else {
                    unlockHandle.style.left = "0px";
                    unlockHandle.style.transition = "left 0.3s ease";
                    currentX = 0;
                 }
            };
            unlockArea.addEventListener("mousedown", start);
            document.addEventListener("mousemove", move);
            document.addEventListener("mouseup", end);
            unlockArea.addEventListener("touchstart", start, { passive: false });
            document.addEventListener("touchmove", move, { passive: false });
            document.addEventListener("touchend", end);
            
            // --- Notification Center Handlers (Vertical Swipe) ---
            let dragStartY = 0;
            let isNotifSwiping = false; 
            const notifThreshold = 50;
            const topSwipeZone = 50;

            notifHomeIndicator.addEventListener('click', closeNotificationCenter);

            function handleNotifStart(y) {
                if (isEditMode) return;
                dragStartY = y;
                isNotifSwiping = true;
                notificationCenter.style.transition = 'none'; 
            }

            // --- FIXED: Replaced corrupted function body ---
            function handleNotifMove(y) {
                if (!isNotifSwiping) return;

                const deltaY = y - dragStartY;
                const notifHeight = notificationCenter.offsetHeight;
                
                // Get current Y position (starts at -notifHeight when closed)
                const notifTransformMatch = notificationCenter.style.transform.match(/(-?\d+(\.\d+)?)/);
                // Ensure we respect the initial closed state (-100% means -notifHeight)
                let currentNotifY = parseFloat(notifTransformMatch?.[0] || -notifHeight);
                
                const isStartingFromClosed = (Math.abs(currentNotifY + notifHeight) < 1);

                let newY;
                
                if (isStartingFromClosed) {
                    // Pulling down from closed state
                    if (deltaY < 0) return; // Don't pull up if already closed
                    newY = Math.max(-notifHeight, Math.min(0, -notifHeight + deltaY));
                } else {
                    // Swiping up from open state (or partially open)
                    // We assume dragStartY was 0 if we started open
                    newY = Math.max(-notifHeight, Math.min(0, deltaY));
                }

                notificationCenter.style.transform = `translateY(${newY}px)`;
            }
            // --- END FIX ---

            // --- NEW: Added missing handleNotifEnd function ---
            function handleNotifEnd(y) {
                if (!isNotifSwiping) return;
                isNotifSwiping = false;

                const notifHeight = notificationCenter.offsetHeight;
                const notifTransformMatch = notificationCenter.style.transform.match(/(-?\d+(\.\d+)?)/);
                const currentNotifY = parseFloat(notifTransformMatch?.[0] || -notifHeight);

                notificationCenter.style.transition = 'transform 0.25s ease-in-out';
                
                // Decide whether to snap open or closed based on 50% threshold
                if (currentNotifY < (-notifHeight / 2)) {
                    // Snap closed
                    notificationCenter.style.transform = 'translateY(-100%)';
                } else {
                    // Snap open
                    notificationCenter.style.transform = 'translateY(0)';
                }
            }
            // --- END NEW ---


            document.addEventListener('mousedown', (e) => {
                // Check if the mousedown is in the top swipe zone to pull down notifications
                const innerScreenRect = innerScreen.getBoundingClientRect();
                if (e.clientY < innerScreenRect.top || e.clientY > innerScreenRect.bottom || e.clientX < innerScreenRect.left || e.clientX > innerScreenRect.right) return;

                const touchRelativeY = e.clientY - innerScreenRect.top;
                
                // 1. Notification Center Swipe Down Logic
                const isNotifClosed = parseFloat(notificationCenter.style.transform.match(/(-?\d+(\.\d+)?)/)?.[0] || -100) <= -100;
                
                if (touchRelativeY <= topSwipeZone && isNotifClosed && lockScreen.style.display === 'none') {
                    handleNotifStart(e.clientY);
                    // Prevent text selection while dragging
                    e.preventDefault(); 
                }

                // 2. Page Swiping Logic (Home Screen)
                const isNotifFullyOpen = parseFloat(notificationCenter.style.transform.match(/(-?\d+(\.\d+)?)/)?.[0] || 0) === 0;
                const isAppOpen = document.querySelector('.app-modal.is-open');
                
                if (!isNotifFullyOpen && !isAppOpen && lockScreen.style.display === 'none') {
                    // Check if click is on the app grid area, not on dock or widget
                    const swipeWrapperRect = document.getElementById('swipe-wrapper').getBoundingClientRect();
                    if (e.clientY >= swipeWrapperRect.top && e.clientY <= swipeWrapperRect.bottom) {
                        isPagingSwiping = true;
                        pageDragStartX = e.clientX;
                        pageContainer.style.transition = 'none'; // Disable transition while dragging
                        // Prevent text selection
                        e.preventDefault();
                    }
                }
            });

            document.addEventListener('mousemove', (e) => {
                if (isNotifSwiping) {
                    handleNotifMove(e.clientY);
                }
                if (isPagingSwiping) {
                    const deltaX = e.clientX - pageDragStartX;
                    const innerScreen = document.getElementById('inner-screen');
                    const pageWidth = innerScreen.offsetWidth;
                    const translateX = -(currentPage - 1) * pageWidth + deltaX;
                    
                    pageContainer.style.transform = `translateX(${translateX}px)`;
                }
            });

            document.addEventListener('mouseup', (e) => {
                if (isNotifSwiping) {
                    handleNotifEnd(e.clientY);
                }
                if (isPagingSwiping) {
                    isPagingSwiping = false;
                    const deltaX = e.clientX - pageDragStartX;

                    if (Math.abs(deltaX) > pageSwipeThreshold) {
                        if (deltaX < 0) {
                            goToPage(currentPage + 1); // Swipe Left (Next)
                        } else {
                            goToPage(currentPage - 1); // Swipe Right (Prev)
                        }
                    } else {
                        goToPage(currentPage); // Snap back
                    }
                }
            });

            // --- Touch Events (Mirror Mouse Events) ---
            document.addEventListener('touchstart', (e) => {
                // Check if the touch is in the top swipe zone
                const innerScreenRect = innerScreen.getBoundingClientRect();
                const touch = e.touches[0];
                if (touch.clientY < innerScreenRect.top || touch.clientY > innerScreenRect.bottom || touch.clientX < innerScreenRect.left || touch.clientX > innerScreenRect.right) return;

                const touchRelativeY = touch.clientY - innerScreenRect.top;
                
                // 1. Notification Center Swipe Down
                const isNotifClosed = parseFloat(notificationCenter.style.transform.match(/(-?\d+(\.\d+)?)/)?.[0] || -100) <= -100;

                if (touchRelativeY <= topSwipeZone && isNotifClosed && lockScreen.style.display === 'none') {
                    handleNotifStart(touch.clientY);
                    e.preventDefault(); // Prevent scrolling
                }

                // 2. Page Swiping Logic (Home Screen)
                const isNotifFullyOpen = parseFloat(notificationCenter.style.transform.match(/(-?\d+(\.\d+)?)/)?.[0] || 0) === 0;
                const isAppOpen = document.querySelector('.app-modal.is-open');

                if (!isNotifFullyOpen && !isAppOpen && lockScreen.style.display === 'none') {
                    // Check if click is on the app grid area, not on dock or widget
                    const swipeWrapperRect = document.getElementById('swipe-wrapper').getBoundingClientRect();
                    if (touch.clientY >= swipeWrapperRect.top && touch.clientY <= swipeWrapperRect.bottom) {
                        isPagingSwiping = true;
                        pageDragStartX = touch.clientX;
                        pageContainer.style.transition = 'none';
                        // We don't preventDefault here unless we are sure it's a swipe, 
                        // otherwise it breaks scrolling inside .app-grid-area
                    }
                }
            }, { passive: false }); 

            document.addEventListener('touchmove', (e) => {
                if (isNotifSwiping) {
                    handleNotifMove(e.touches[0].clientY);
                }
                if (isPagingSwiping) {
                    const deltaX = e.touches[0].clientX - pageDragStartX;
                    const innerScreen = document.getElementById('inner-screen');
                    const pageWidth = innerScreen.offsetWidth;
                    const translateX = -(currentPage - 1) * pageWidth + deltaX;
                    
                    pageContainer.style.transform = `translateX(${translateX}px)`;
                    
                    // If horizontal swipe is significant, prevent vertical scroll
                    if (Math.abs(deltaX) > 10) {
                         e.preventDefault();
                    }
                }
            }, { passive: false }); 

            document.addEventListener('touchend', (e) => {
                if (isNotifSwiping) {
                    handleNotifEnd(e.changedTouches[0].clientY);
                }
                 if (isPagingSwiping) {
                    isPagingSwiping = false;
                    const deltaX = e.changedTouches[0].clientX - pageDragStartX;

                    if (Math.abs(deltaX) > pageSwipeThreshold) {
                        if (deltaX < 0) {
                            goToPage(currentPage + 1); // Swipe Left (Next)
                        } else {
                            goToPage(currentPage - 1); // Swipe Right (Prev)
                        }
                    } else {
                        goToPage(currentPage); // Snap back
                    }
                }
            });

            
            // --- REMOVED: Toast/Message Utility (Moved outside) ---
            

            // --- Initial Setup ---
            updatePaginationDots(); // Initialize dots state
            
        });
    </script>
</body>
</html>
