<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <!-- Dock/navigation bar -->
    <div class="dock">
        <!-- Existing content -->
    </div>

    <!-- 🌐 蓝牙连接按钮区域（插入点：Dock 之后，Home 指示器之前） -->
    <div class="bluetooth-section w-full flex justify-center mt-3">
      <button id="bluetoothButton" class="bluetooth-btn">
        🔵 蓝牙连接
      </button>
      <div id="status" class="bluetooth-status ml-3">未连接</div>
    </div>

    <!-- ✨ 按钮动画和样式（局部样式，可根据需要合并到全局 CSS） -->
    <style>
      .bluetooth-section {
        width: 100%;
        text-align: center;
        margin-top: 12px;
      }

      .bluetooth-btn {
        background: linear-gradient(135deg, #4f8ef7, #00c2ff);
        color: white;
        border: none;
        border-radius: 40px;
        padding: 10px 22px;
        font-size: 16px;
        cursor: pointer;
        transition: all 0.3s ease;
        box-shadow: 0 4px 15px rgba(0, 162, 255, 0.4);
      }

      .bluetooth-btn:hover {
        transform: scale(1.03);
        background: linear-gradient(135deg, #00c2ff, #4f8ef7);
        box-shadow: 0 6px 20px rgba(0, 162, 255, 0.6);
      }

      .bluetooth-btn:active {
        transform: scale(0.98);
      }

      .bluetooth-status {
        margin-top: 0;
        font-size: 14px;
        color: #bbb;
        transition: color 0.3s;
        display: inline-block;
        vertical-align: middle;
      }
    </style>

    <!-- ⚙️ 蓝牙连接逻辑（使用 Web Bluetooth API） -->
    <script>
      (function(){
        const bluetoothButton = document.getElementById("bluetoothButton");
        const statusBox = document.getElementById("status");

        bluetoothButton.addEventListener("click", async () => {
          if (!navigator.bluetooth) {
            statusBox.textContent = "❌ 当前浏览器不支持 Web Bluetooth";
            statusBox.style.color = "red";
            return;
          }

          try {
            statusBox.textContent = "🔍 搜索蓝牙设备中...";
            statusBox.style.color = "blue";

            const device = await navigator.bluetooth.requestDevice({
              acceptAllDevices: true,
              optionalServices: ["battery_service"]
            });

            statusBox.textContent = `🔗 正在连接 ${device.name || "未知设备"}...`;
            const server = await device.gatt.connect();

            statusBox.textContent = `✅ 已连接：${device.name || "未知设备"}`;
            statusBox.style.color = "green";

            // 可选：监听断开事件
            device.addEventListener("gattserverdisconnected", () => {
              statusBox.textContent = "🔴 蓝牙已断开";
              statusBox.style.color = "red";
            });

          } catch (error) {
            statusBox.textContent = `⚠️ 连接失败：${error.message}`;
            statusBox.style.color = "orange";
          }
        });
      })();
    </script>

    <!-- Home Indicator div -->
    <div class="home-indicator">
        <!-- Existing content -->
    </div>
</body>
</html>